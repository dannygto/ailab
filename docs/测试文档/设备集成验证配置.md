# 设备集成验证配置

*更新日期：2025年7月23日*

## 配置概述

本文档包含了TCP/Socket协议适配器与各类实验设备集成测试的配置信息。这些配置将用于验证适配器能否成功连接并与设备进行通信。

## 实验设备列表

以下是计划进行集成测试的实验设备列表：

| 设备ID | 设备名称 | 设备类型 | 通信模式 | IP地址/端口 | 协议特性 |
|-------|---------|---------|---------|------------|---------|
| dev-001 | 数字信号处理器DSP-A103 | processor | client | 192.168.1.101:5001 | 二进制协议，帧头0xAA55 |
| dev-002 | 电机控制器MC-200 | controller | client | 192.168.1.102:5002 | 文本协议，JSON格式 |
| dev-003 | 数据采集板DAQ-5000 | sensor | client | 192.168.1.103:5003 | 二进制协议，大端序 |
| dev-004 | 实验流体力学设备 | analyzer | server | 0.0.0.0:5004 | 自定义协议，帧头0xBEEF |
| dev-005 | 光谱分析仪SA-3000 | analyzer | client | 192.168.1.105:5005 | 文本协议，CSV格式 |
| dev-006 | 工业机器人控制器RBC-01 | robot | client | 192.168.1.106:5006 | 二进制协议，帧头0x5050 |
| dev-007 | 环境传感器阵列ESA-10 | sensor | server | 0.0.0.0:5007 | 文本协议，JSON格式 |
| dev-008 | 生物反应器BR-5000 | reactor | client | 192.168.1.108:5008 | 文本协议，自定义格式 |
| dev-009 | 光学测量系统OMS-200 | optical | client | 192.168.1.109:5009 | 二进制协议，帧头0xCDEF |
| dev-010 | 温控加热板TCH-100 | controller | client | 192.168.1.110:5010 | 简单文本命令协议 |

## 设备通信协议详情

### 1. 数字信号处理器DSP-A103 (dev-001)

```json
{
  "connectionConfig": {
    "host": "192.168.1.101",
    "port": 5001,
    "connectionTimeout": 5000,
    "keepAlive": true,
    "noDelay": true,
    "autoReconnect": true,
    "deviceType": "PROCESSOR"
  },
  "secureConfig": {
    "secure": false
  },
  "dataFormat": {
    "encoding": "binary",
    "endianness": "little",
    "frameDelimiter": "0xAA55",
    "frameSize": "variable",
    "checksumEnabled": true,
    "checksumType": "CRC16"
  },
  "commandSet": {
    "initialize": { "cmd": "0x01", "params": [] },
    "reset": { "cmd": "0x02", "params": [] },
    "startProcess": { "cmd": "0x10", "params": ["processId"] },
    "stopProcess": { "cmd": "0x11", "params": ["processId"] },
    "getStatus": { "cmd": "0x20", "params": [] },
    "getData": { "cmd": "0x30", "params": ["dataType", "startIndex", "count"] }
  }
}
```

### 2. 电机控制器MC-200 (dev-002)

```json
{
  "connectionConfig": {
    "host": "192.168.1.102",
    "port": 5002,
    "connectionTimeout": 3000,
    "keepAlive": true,
    "noDelay": true,
    "autoReconnect": true,
    "deviceType": "CONTROLLER"
  },
  "secureConfig": {
    "secure": true,
    "rejectUnauthorized": true
  },
  "dataFormat": {
    "encoding": "utf8",
    "frameDelimiter": "\r\n",
    "jsonFormat": true
  },
  "commandSet": {
    "initialize": { "cmd": "INIT", "params": {} },
    "reset": { "cmd": "RESET", "params": {} },
    "setSpeed": { "cmd": "SET_SPEED", "params": { "motor": "number", "speed": "number" } },
    "setPosition": { "cmd": "SET_POS", "params": { "motor": "number", "position": "number" } },
    "getStatus": { "cmd": "GET_STATUS", "params": { "motor": "number" } },
    "stop": { "cmd": "STOP", "params": { "motor": "number" } }
  }
}
```

### 3. 数据采集板DAQ-5000 (dev-003)

```json
{
  "connectionConfig": {
    "host": "192.168.1.103",
    "port": 5003,
    "connectionTimeout": 2000,
    "keepAlive": true,
    "retryCount": 3,
    "retryDelay": 1000,
    "autoReconnect": true,
    "deviceType": "SENSOR"
  },
  "secureConfig": {
    "secure": false
  },
  "dataFormat": {
    "encoding": "binary",
    "endianness": "big",
    "frameSize": "fixed",
    "frameLength": 256,
    "checksumEnabled": true,
    "checksumType": "CRC32"
  },
  "commandSet": {
    "initialize": { "cmd": [0x01, 0x00], "responseLength": 4 },
    "startSampling": { "cmd": [0x02, 0x01], "params": ["channelMask", "sampleRate"], "responseLength": 4 },
    "stopSampling": { "cmd": [0x02, 0x00], "responseLength": 4 },
    "getConfig": { "cmd": [0x03, 0x00], "responseLength": 128 },
    "setConfig": { "cmd": [0x04, 0x00], "params": ["configData"], "responseLength": 4 }
  }
}
```

### 4. 实验流体力学设备 (dev-004)

```json
{
  "connectionConfig": {
    "port": 5004,
    "mode": "server",
    "connectionTimeout": 10000,
    "keepAlive": true,
    "noDelay": true,
    "deviceType": "ANALYZER"
  },
  "secureConfig": {
    "secure": false
  },
  "dataFormat": {
    "encoding": "binary",
    "endianness": "big",
    "frameDelimiter": "0xBEEF",
    "frameSize": "variable",
    "checksumEnabled": true,
    "checksumType": "Fletcher32"
  },
  "commandSet": {
    "initialize": { "cmd": [0xBE, 0xEF, 0x01, 0x00], "responseLength": 8 },
    "startFlow": { "cmd": [0xBE, 0xEF, 0x02, 0x01], "params": ["flowRate", "duration"], "responseLength": 8 },
    "stopFlow": { "cmd": [0xBE, 0xEF, 0x02, 0x00], "responseLength": 8 },
    "getMeasurement": { "cmd": [0xBE, 0xEF, 0x03, 0x00], "params": ["measurementType"], "responseLength": 256 }
  }
}
```

### 5. 光谱分析仪SA-3000 (dev-005)

```json
{
  "connectionConfig": {
    "host": "192.168.1.105",
    "port": 5005,
    "connectionTimeout": 5000,
    "keepAlive": true,
    "noDelay": false,
    "autoReconnect": true,
    "deviceType": "ANALYZER"
  },
  "secureConfig": {
    "secure": true,
    "rejectUnauthorized": true
  },
  "dataFormat": {
    "encoding": "utf8",
    "frameDelimiter": "\r\n",
    "csvFormat": true
  },
  "commandSet": {
    "initialize": { "cmd": "*RST", "response": "OK" },
    "selfTest": { "cmd": "*TST", "response": "OK" },
    "startScan": { "cmd": "SCAN:START {startWavelength},{endWavelength},{stepSize}", "response": "OK" },
    "stopScan": { "cmd": "SCAN:STOP", "response": "OK" },
    "getResult": { "cmd": "SCAN:RESULT?", "response": "CSV_DATA" }
  }
}
```

## 测试场景

针对每个设备，计划执行以下测试场景：

1. **基本连接测试**
   - 建立连接
   - 发送初始化命令
   - 接收响应
   - 关闭连接

2. **命令执行测试**
   - 发送每个支持的命令
   - 验证响应格式和内容
   - 测试参数边界值

3. **数据流测试**
   - 启动持续数据采集
   - 验证数据流格式
   - 测试高速数据传输

4. **错误处理测试**
   - 发送无效命令
   - 发送格式错误的命令
   - 模拟网络中断
   - 测试自动重连机制

5. **性能测试**
   - 测量命令响应时间
   - 测试最大数据吞吐量
   - 评估CPU和内存使用情况

## 测试环境配置

### 网络环境

```json
{
  "testNetwork": {
    "subnet": "192.168.1.0/24",
    "gateway": "192.168.1.1",
    "dhcpEnabled": false
  },
  "testComputer": {
    "ip": "192.168.1.2",
    "mask": "255.255.255.0"
  },
  "internetAccess": false,
  "firewallRules": [
    "允许TCP 5001-5010端口入站连接",
    "允许TCP 5001-5010端口出站连接"
  ]
}
```

### 测试服务器配置

```json
{
  "hardware": {
    "cpu": "Intel i7-12700",
    "cores": 12,
    "memory": "32GB",
    "disk": "SSD 1TB"
  },
  "software": {
    "os": "Ubuntu 22.04 LTS",
    "nodejs": "v18.16.0",
    "npm": "9.6.4"
  },
  "network": {
    "interfaces": [
      {
        "name": "eth0",
        "ip": "192.168.1.2",
        "mask": "255.255.255.0",
        "gateway": "192.168.1.1"
      }
    ]
  }
}
```

## 备注

1. 所有设备都需要事先连接到测试网络，并配置好固定IP地址
2. 测试前需确认所有设备处于正常工作状态
3. 对于需要认证的设备，测试前需将测试证书预先安装
4. 每个设备测试后需记录日志并生成测试报告
5. 在无法访问实际设备的情况下，可使用设备模拟器进行初步测试

---

*编制人：张设备  
审核人：王测试  
批准人：李项目*
