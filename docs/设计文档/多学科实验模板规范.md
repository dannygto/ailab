# 多学科实验模板规范

## 1. 概述

多学科实验模板规范是AI辅助教学实验平台的核心标准之一，旨在提供统一的实验模板定义框架，支持跨学科、多层次的实验教学需求。本规范定义了实验模板的基本结构、数据格式、交互规则和扩展机制，为实验教学的标准化和智能化提供基础。

## 2. 实验模板基本结构

### 2.1 模板元数据

每个实验模板必须包含以下基本元数据：

```json
{
  "templateId": "unique-template-id",
  "version": "1.0.0",
  "name": {
    "zh-CN": "实验模板名称",
    "en-US": "Experiment Template Name"
  },
  "description": {
    "zh-CN": "实验模板详细描述...",
    "en-US": "Detailed description of the experiment template..."
  },
  "subject": "physics|chemistry|biology|engineering|computer-science|...",
  "level": "elementary|intermediate|advanced",
  "estimatedDuration": 90,  // 分钟
  "tags": ["tag1", "tag2", "tag3"],
  "author": {
    "name": "Author Name",
    "institution": "Institution Name",
    "email": "author@example.com"
  },
  "createdAt": "2025-07-20T10:30:00Z",
  "updatedAt": "2025-07-21T15:45:00Z",
  "license": "CC-BY-4.0"
}
```

### 2.2 实验结构定义

实验模板的核心结构包括：

```json
{
  "structure": {
    "objectives": [
      {
        "id": "obj-1",
        "content": "掌握..."
      }
    ],
    "prerequisites": [
      {
        "id": "prereq-1",
        "content": "了解..."
      }
    ],
    "sections": [
      {
        "id": "section-1",
        "title": "实验准备",
        "type": "preparation",
        "steps": []
      },
      {
        "id": "section-2",
        "title": "实验过程",
        "type": "procedure",
        "steps": []
      },
      {
        "id": "section-3",
        "title": "数据分析",
        "type": "analysis",
        "steps": []
      },
      {
        "id": "section-4",
        "title": "实验报告",
        "type": "report",
        "steps": []
      }
    ]
  }
}
```

### 2.3 实验步骤定义

每个实验步骤的详细定义：

```json
{
  "step": {
    "id": "step-1",
    "title": "步骤标题",
    "description": "步骤详细描述...",
    "type": "instruction|operation|observation|calculation|question",
    "duration": 10,  // 预计完成时间（分钟）
    "resources": [], // 相关资源
    "devices": [],   // 需要的设备
    "actions": [],   // 步骤相关操作
    "data": {        // 步骤相关数据
      "inputs": [],
      "outputs": []
    },
    "validation": {  // 步骤验证规则
      "type": "automatic|manual",
      "criteria": []
    },
    "hints": [],     // 步骤提示
    "nextSteps": {   // 条件下一步
      "default": "step-2",
      "conditions": []
    }
  }
}
```

## 3. 学科分类与特性

### 3.1 主要学科分类

系统支持以下主要学科分类及其特定实验特性：

1. **物理学**
   - 力学实验
   - 电磁学实验
   - 光学实验
   - 热学实验
   - 现代物理实验

2. **化学**
   - 无机化学实验
   - 有机化学实验
   - 分析化学实验
   - 物理化学实验
   - 材料化学实验

3. **生物学**
   - 细胞生物学实验
   - 分子生物学实验
   - 微生物学实验
   - 生态学实验
   - 生理学实验

4. **工程学**
   - 电子工程实验
   - 机械工程实验
   - 土木工程实验
   - 化学工程实验
   - 材料工程实验

5. **计算机科学**
   - 编程实验
   - 算法与数据结构实验
   - 计算机网络实验
   - 数据库实验
   - 人工智能实验

6. **医学**
   - 解剖学实验
   - 生理学实验
   - 病理学实验
   - 药理学实验
   - 医学影像实验

7. **地球科学**
   - 地质学实验
   - 大气科学实验
   - 海洋学实验
   - 环境科学实验
   - 地理信息系统实验

### 3.2 学科特定属性

针对不同学科，实验模板可以定义特定属性：

```json
{
  "subjectSpecificAttributes": {
    "physics": {
      "phenomena": ["wave", "electric-field", "magnetic-field"],
      "measurements": ["force", "velocity", "electric-current"],
      "constants": ["gravitational-constant", "planck-constant"]
    },
    "chemistry": {
      "reactionType": ["acid-base", "redox", "precipitation"],
      "hazardLevel": "low|medium|high",
      "chemicals": [
        {
          "name": "Sodium Chloride",
          "formula": "NaCl",
          "amount": "5g",
          "concentration": "0.1M"
        }
      ]
    },
    "biology": {
      "organismType": ["bacteria", "plant", "animal"],
      "biologicalLevel": ["cellular", "tissue", "organ", "organism"],
      "safetyPrecautions": ["biosafety-level-1"]
    },
    "computerScience": {
      "programmingLanguages": ["python", "java", "c++"],
      "computationalComplexity": "O(n)",
      "softwareRequirements": ["docker", "jupyter-notebook"]
    }
  }
}
```

## 4. 实验模板数据模型

### 4.1 资源定义

实验中使用的各类资源定义：

```json
{
  "resources": [
    {
      "id": "resource-1",
      "type": "document|image|video|simulation|dataset|code",
      "name": "资源名称",
      "description": "资源描述",
      "url": "resource-url-or-path",
      "format": "pdf|jpg|mp4|csv|py",
      "license": "CC-BY-4.0",
      "metadata": {}
    }
  ]
}
```

### 4.2 设备定义

实验需要的设备定义：

```json
{
  "deviceRequirements": [
    {
      "id": "device-req-1",
      "type": "oscilloscope|microscope|server|sensor",
      "name": "设备名称",
      "description": "设备描述",
      "specifications": {
        "minVersion": "1.0",
        "capabilities": ["capability-1", "capability-2"]
      },
      "configuration": {},
      "fallbackOptions": ["alternative-device-1"]
    }
  ]
}
```

### 4.3 数据采集定义

实验数据采集的定义：

```json
{
  "dataCollection": {
    "measurements": [
      {
        "id": "measurement-1",
        "name": "测量名称",
        "description": "测量描述",
        "unit": "m/s",
        "range": {
          "min": 0,
          "max": 100
        },
        "precision": 0.01,
        "samplingRate": 10,  // 每秒采样次数
        "duration": 60,      // 采样持续时间（秒）
        "dataFormat": "time-series|scalar|vector|matrix",
        "visualization": {
          "type": "line-chart|bar-chart|scatter-plot",
          "options": {}
        }
      }
    ],
    "dataProcessing": {
      "preprocessing": [],
      "analysis": [],
      "export": []
    }
  }
}
```

### 4.4 评估与反馈

实验评估与反馈机制：

```json
{
  "assessment": {
    "criteria": [
      {
        "id": "criterion-1",
        "name": "评估标准名称",
        "description": "评估标准描述",
        "weight": 0.3,
        "rubric": [
          {
            "score": 5,
            "description": "优秀表现描述"
          },
          {
            "score": 3,
            "description": "良好表现描述"
          },
          {
            "score": 1,
            "description": "需要改进描述"
          }
        ]
      }
    ],
    "automatedChecks": [
      {
        "id": "check-1",
        "type": "value-range|pattern-match|code-test",
        "target": "measurement-1",
        "condition": "value > 50 && value < 60",
        "feedback": {
          "pass": "很好！测量值在预期范围内。",
          "fail": "测量值超出了预期范围，请检查实验设置。"
        }
      }
    ],
    "feedbackTypes": [
      {
        "id": "feedback-1",
        "type": "immediate|delayed|formative|summative",
        "trigger": "step-completion|section-completion|experiment-completion",
        "content": "反馈内容模板",
        "adaptivity": {
          "conditions": [],
          "actions": []
        }
      }
    ]
  }
}
```

## 5. 实验模板适配机制

### 5.1 难度适配

针对不同学习者水平的难度适配：

```json
{
  "difficultyAdaptation": {
    "levels": [
      {
        "id": "novice",
        "modifications": {
          "stepDetails": "增加详细说明和指导",
          "hints": "提供更多提示",
          "scaffolding": "增加辅助结构"
        }
      },
      {
        "id": "intermediate",
        "modifications": {
          "stepDetails": "标准详细程度",
          "hints": "适量提示",
          "scaffolding": "部分辅助结构"
        }
      },
      {
        "id": "advanced",
        "modifications": {
          "stepDetails": "简化说明",
          "hints": "最少提示",
          "scaffolding": "移除大部分辅助结构"
        }
      }
    ]
  }
}
```

### 5.2 资源适配

针对不同教学环境的资源适配：

```json
{
  "resourceAdaptation": {
    "environments": [
      {
        "id": "full-lab",
        "deviceRequirements": ["device-req-1", "device-req-2"]
      },
      {
        "id": "limited-lab",
        "deviceRequirements": ["device-req-1"],
        "alternatives": {
          "device-req-2": "simulation-1"
        }
      },
      {
        "id": "remote-learning",
        "deviceRequirements": [],
        "alternatives": {
          "device-req-1": "simulation-2",
          "device-req-2": "simulation-3"
        }
      }
    ]
  }
}
```

### 5.3 时间适配

针对不同课时长度的时间适配：

```json
{
  "timeAdaptation": {
    "durations": [
      {
        "id": "short-session",
        "totalTime": 45,
        "modifications": {
          "sections": ["section-1", "section-2"],
          "steps": {
            "include": ["step-1", "step-2", "step-5"],
            "exclude": ["step-3", "step-4"]
          }
        }
      },
      {
        "id": "standard-session",
        "totalTime": 90,
        "modifications": {
          "sections": ["section-1", "section-2", "section-3"],
          "steps": {
            "include": ["step-1", "step-2", "step-3", "step-4", "step-5"],
            "exclude": []
          }
        }
      },
      {
        "id": "extended-session",
        "totalTime": 180,
        "modifications": {
          "sections": ["section-1", "section-2", "section-3", "section-4"],
          "steps": {
            "include": ["step-1", "step-2", "step-3", "step-4", "step-5", "step-6", "step-7"],
            "exclude": []
          },
          "additionalContent": ["advanced-analysis", "extension-activities"]
        }
      }
    ]
  }
}
```

## 6. AI辅助功能集成

### 6.1 智能指导

AI辅助实验指导配置：

```json
{
  "aiAssistance": {
    "guidance": {
      "enabled": true,
      "interventionPoints": [
        {
          "id": "intervention-1",
          "triggerType": "user-request|error-detection|time-threshold",
          "conditions": "step.duration > step.estimatedDuration * 1.5",
          "actions": {
            "suggestHint": true,
            "offerAdditionalExplanation": true
          }
        }
      ],
      "knowledgeBase": ["kb-section-1", "kb-section-2"]
    }
  }
}
```

### 6.2 数据分析辅助

AI辅助数据分析配置：

```json
{
  "aiDataAnalysis": {
    "enabled": true,
    "analysisTypes": [
      {
        "id": "trend-analysis",
        "description": "识别数据中的趋势和模式",
        "applicableData": ["measurement-1", "measurement-2"],
        "methods": ["regression", "time-series-analysis"],
        "visualization": {
          "type": "trend-line|pattern-highlight",
          "options": {}
        }
      },
      {
        "id": "anomaly-detection",
        "description": "检测异常数据点",
        "applicableData": ["measurement-3"],
        "methods": ["statistical-outlier", "clustering"],
        "feedback": {
          "template": "检测到可能的异常值: {{value}} 在 {{timestamp}}，可能原因: {{reasons}}"
        }
      }
    ]
  }
}
```

### 6.3 实验报告生成

AI辅助实验报告生成配置：

```json
{
  "aiReportGeneration": {
    "enabled": true,
    "templates": [
      {
        "id": "standard-report",
        "sections": [
          {
            "title": "实验目的",
            "contentType": "auto-generated|user-input",
            "source": "experiment.objectives"
          },
          {
            "title": "实验方法",
            "contentType": "auto-generated|user-input",
            "source": "experiment.sections[type=procedure]"
          },
          {
            "title": "实验结果",
            "contentType": "auto-generated|user-input",
            "source": "experiment.dataCollection.measurements",
            "visualization": true
          },
          {
            "title": "分析讨论",
            "contentType": "ai-assisted|user-input",
            "aiPrompt": "根据实验结果分析{{key_finding}}与理论预期的关系"
          },
          {
            "title": "结论",
            "contentType": "ai-assisted|user-input",
            "aiPrompt": "总结实验的主要发现和意义"
          }
        ]
      }
    ]
  }
}
```

## 7. 模板创建与管理

### 7.1 模板创建流程

1. **基本信息定义**
   - 填写模板元数据
   - 选择学科类别和教学级别

2. **实验结构设计**
   - 定义实验目标
   - 创建实验部分和步骤
   - 设置步骤间逻辑关系

3. **资源与设备配置**
   - 添加实验所需资源
   - 定义设备需求
   - 设置数据采集配置

4. **评估设置**
   - 创建评估标准
   - 设置自动检查规则
   - 配置反馈机制

5. **适应性配置**
   - 设置难度适配选项
   - 配置资源适配方案
   - 定义时间适配策略

6. **AI功能设置**
   - 配置智能指导参数
   - 设置数据分析辅助
   - 定义报告生成模板

7. **测试与发布**
   - 预览实验流程
   - 模拟不同场景测试
   - 版本控制与发布

### 7.2 模板管理工具

模板管理系统提供以下工具：

1. **模板编辑器**
   - 可视化结构编辑
   - 代码视图编辑
   - 实时预览

2. **模板库**
   - 分类浏览
   - 搜索功能
   - 版本管理

3. **模板共享**
   - 导出/导入功能
   - 共享权限设置
   - 协作编辑

4. **模板验证**
   - 结构完整性检查
   - 资源可用性验证
   - 适配性测试

## 8. 模板示例

### 8.1 物理学实验示例：自由落体实验

```json
{
  "templateId": "physics-free-fall-001",
  "version": "1.0.0",
  "name": {
    "zh-CN": "自由落体实验",
    "en-US": "Free Fall Experiment"
  },
  "subject": "physics",
  "level": "intermediate",
  "estimatedDuration": 45,
  "tags": ["mechanics", "gravity", "kinematics"],
  
  "structure": {
    "objectives": [
      {
        "id": "obj-1",
        "content": "验证自由落体运动规律"
      },
      {
        "id": "obj-2",
        "content": "测量重力加速度"
      }
    ],
    "sections": [
      {
        "id": "section-1",
        "title": "实验准备",
        "steps": [
          {
            "id": "step-1",
            "title": "准备实验设备",
            "description": "确认光电门计时器、金属小球、实验支架已正确安装。",
            "devices": ["timing-gate", "metal-ball", "stand"]
          }
        ]
      },
      {
        "id": "section-2",
        "title": "实验过程",
        "steps": [
          {
            "id": "step-2",
            "title": "测量小球直径",
            "description": "使用游标卡尺测量金属小球的直径。",
            "data": {
              "inputs": [
                {
                  "id": "ball-diameter",
                  "name": "小球直径",
                  "unit": "mm",
                  "type": "number"
                }
              ]
            }
          },
          {
            "id": "step-3",
            "title": "设置不同高度",
            "description": "设置小球落下的不同高度，从低到高设置5个不同高度。",
            "data": {
              "inputs": [
                {
                  "id": "heights",
                  "name": "释放高度集合",
                  "unit": "cm",
                  "type": "array-of-numbers",
                  "count": 5
                }
              ]
            }
          },
          {
            "id": "step-4",
            "title": "进行多次测量",
            "description": "对每个高度进行3次落体时间测量。",
            "data": {
              "inputs": [
                {
                  "id": "time-measurements",
                  "name": "时间测量结果",
                  "unit": "s",
                  "type": "matrix",
                  "rows": 5,
                  "columns": 3
                }
              ]
            }
          }
        ]
      },
      {
        "id": "section-3",
        "title": "数据分析",
        "steps": [
          {
            "id": "step-5",
            "title": "计算平均时间",
            "description": "计算每个高度的平均时间。",
            "data": {
              "outputs": [
                {
                  "id": "average-times",
                  "name": "平均时间",
                  "unit": "s",
                  "type": "array-of-numbers",
                  "derivation": "average(time-measurements, axis=1)"
                }
              ]
            }
          },
          {
            "id": "step-6",
            "title": "计算重力加速度",
            "description": "使用公式 g = 2h/t² 计算每次测量的重力加速度值。",
            "data": {
              "outputs": [
                {
                  "id": "g-values",
                  "name": "重力加速度值",
                  "unit": "m/s²",
                  "type": "array-of-numbers",
                  "derivation": "2*heights/(average-times^2)"
                }
              ]
            }
          },
          {
            "id": "step-7",
            "title": "绘制高度-时间平方图",
            "description": "绘制高度(h)与时间平方(t²)的关系图。",
            "data": {
              "visualization": {
                "type": "scatter-plot",
                "xAxis": {
                  "data": "average-times^2",
                  "label": "时间平方 (s²)"
                },
                "yAxis": {
                  "data": "heights",
                  "label": "高度 (m)"
                },
                "regression": true
              }
            }
          }
        ]
      },
      {
        "id": "section-4",
        "title": "实验报告",
        "steps": [
          {
            "id": "step-8",
            "title": "计算最终结果",
            "description": "计算重力加速度的平均值和标准差。",
            "data": {
              "outputs": [
                {
                  "id": "final-g",
                  "name": "重力加速度最终值",
                  "unit": "m/s²",
                  "type": "number",
                  "derivation": "average(g-values)"
                },
                {
                  "id": "g-std-dev",
                  "name": "重力加速度标准差",
                  "unit": "m/s²",
                  "type": "number",
                  "derivation": "std_dev(g-values)"
                }
              ]
            }
          },
          {
            "id": "step-9",
            "title": "分析误差来源",
            "description": "分析可能的误差来源及其影响。",
            "data": {
              "inputs": [
                {
                  "id": "error-analysis",
                  "name": "误差分析",
                  "type": "text"
                }
              ]
            }
          },
          {
            "id": "step-10",
            "title": "得出结论",
            "description": "根据实验数据分析得出结论。",
            "data": {
              "inputs": [
                {
                  "id": "conclusion",
                  "name": "实验结论",
                  "type": "text"
                }
              ]
            },
            "aiAssistance": {
              "suggestion": "根据您的数据，重力加速度测量值为 {{final-g}} ± {{g-std-dev}} m/s²，与理论值 9.8 m/s² 相比有 {{(final-g-9.8)/9.8*100}}% 的误差。考虑到可能的误差来源包括空气阻力、计时误差等。"
            }
          }
        ]
      }
    ]
  },
  
  "assessment": {
    "criteria": [
      {
        "id": "data-collection",
        "name": "数据采集",
        "weight": 0.3,
        "rubric": [
          {
            "score": 5,
            "description": "完整收集所有高度的多次测量数据，操作规范。"
          },
          {
            "score": 3,
            "description": "收集了大部分数据，操作基本规范。"
          },
          {
            "score": 1,
            "description": "数据收集不完整，操作不规范。"
          }
        ]
      },
      {
        "id": "data-analysis",
        "name": "数据分析",
        "weight": 0.4,
        "rubric": [
          {
            "score": 5,
            "description": "正确计算重力加速度，绘制图表，分析透彻。"
          },
          {
            "score": 3,
            "description": "基本正确计算和分析，图表基本合理。"
          },
          {
            "score": 1,
            "description": "计算有误，分析不充分。"
          }
        ]
      },
      {
        "id": "conclusion",
        "name": "结论与误差分析",
        "weight": 0.3,
        "rubric": [
          {
            "score": 5,
            "description": "结论清晰，误差分析全面且有深度。"
          },
          {
            "score": 3,
            "description": "结论基本正确，误差分析基本合理。"
          },
          {
            "score": 1,
            "description": "结论模糊，误差分析不充分。"
          }
        ]
      }
    ],
    "automatedChecks": [
      {
        "id": "g-value-check",
        "type": "value-range",
        "target": "final-g",
        "condition": "value > 9.0 && value < 10.5",
        "feedback": {
          "pass": "重力加速度测量结果在合理范围内。",
          "fail": "重力加速度测量结果超出预期范围，请检查数据和计算。"
        }
      }
    ]
  },
  
  "aiAssistance": {
    "guidance": {
      "enabled": true,
      "interventionPoints": [
        {
          "id": "height-setting-guidance",
          "triggerType": "error-detection",
          "conditions": "max(heights) - min(heights) < 50",
          "actions": {
            "suggestHint": true,
            "message": "为获得更准确的结果，建议设置的高度差异应大于50cm。"
          }
        },
        {
          "id": "data-inconsistency-guidance",
          "triggerType": "error-detection",
          "conditions": "std_dev(time-measurements, axis=1) / average(time-measurements, axis=1) > 0.1",
          "actions": {
            "suggestHint": true,
            "message": "同一高度的多次测量时间差异较大，可能存在测量误差。建议检查实验设置或重新测量。"
          }
        }
      ]
    },
    "dataAnalysis": {
      "enabled": true,
      "analysisTypes": [
        {
          "id": "regression-analysis",
          "description": "线性回归分析高度与时间平方的关系",
          "applicableData": ["heights", "average-times"],
          "methods": ["linear-regression"],
          "output": {
            "id": "regression-g",
            "name": "通过回归计算的重力加速度",
            "unit": "m/s²",
            "derivation": "2 * slope(heights vs average-times^2)"
          }
        }
      ]
    }
  }
}
```

### 8.2 计算机科学实验示例：排序算法比较

```json
{
  "templateId": "cs-sorting-algorithms-001",
  "version": "1.0.0",
  "name": {
    "zh-CN": "排序算法性能比较实验",
    "en-US": "Sorting Algorithm Performance Comparison"
  },
  "subject": "computer-science",
  "level": "intermediate",
  "estimatedDuration": 90,
  "tags": ["algorithms", "sorting", "performance-analysis"],
  
  "structure": {
    "objectives": [
      {
        "id": "obj-1",
        "content": "实现并比较不同排序算法的性能"
      },
      {
        "id": "obj-2",
        "content": "分析排序算法的时间复杂度和空间复杂度"
      },
      {
        "id": "obj-3",
        "content": "理解算法性能与输入数据特性的关系"
      }
    ],
    "sections": [
      {
        "id": "section-1",
        "title": "算法实现",
        "steps": [
          {
            "id": "step-1",
            "title": "实现冒泡排序",
            "description": "按照伪代码实现冒泡排序算法。",
            "resources": [
              {
                "id": "bubble-sort-pseudo",
                "type": "code",
                "name": "冒泡排序伪代码",
                "content": "function bubbleSort(array):\n    n = length(array)\n    for i from 0 to n-1:\n        for j from 0 to n-i-1:\n            if array[j] > array[j+1]:\n                swap array[j] and array[j+1]\n    return array"
              }
            ],
            "data": {
              "inputs": [
                {
                  "id": "bubble-sort-implementation",
                  "name": "冒泡排序实现",
                  "type": "code",
                  "language": "python"
                }
              ]
            }
          },
          {
            "id": "step-2",
            "title": "实现快速排序",
            "description": "按照伪代码实现快速排序算法。",
            "resources": [
              {
                "id": "quick-sort-pseudo",
                "type": "code",
                "name": "快速排序伪代码",
                "content": "function quickSort(array, low, high):\n    if low < high:\n        pivot_index = partition(array, low, high)\n        quickSort(array, low, pivot_index - 1)\n        quickSort(array, pivot_index + 1, high)\n\nfunction partition(array, low, high):\n    pivot = array[high]\n    i = low - 1\n    for j from low to high - 1:\n        if array[j] <= pivot:\n            i = i + 1\n            swap array[i] and array[j]\n    swap array[i + 1] and array[high]\n    return i + 1"
              }
            ],
            "data": {
              "inputs": [
                {
                  "id": "quick-sort-implementation",
                  "name": "快速排序实现",
                  "type": "code",
                  "language": "python"
                }
              ]
            }
          },
          {
            "id": "step-3",
            "title": "实现归并排序",
            "description": "按照伪代码实现归并排序算法。",
            "resources": [
              {
                "id": "merge-sort-pseudo",
                "type": "code",
                "name": "归并排序伪代码",
                "content": "function mergeSort(array):\n    if length(array) <= 1:\n        return array\n    \n    middle = length(array) / 2\n    left = array[0...middle-1]\n    right = array[middle...length(array)-1]\n    \n    left = mergeSort(left)\n    right = mergeSort(right)\n    \n    return merge(left, right)\n\nfunction merge(left, right):\n    result = []\n    while length(left) > 0 and length(right) > 0:\n        if left[0] <= right[0]:\n            append left[0] to result\n            left = left[1...length(left)-1]\n        else:\n            append right[0] to result\n            right = right[1...length(right)-1]\n    \n    while length(left) > 0:\n        append left[0] to result\n        left = left[1...length(left)-1]\n    \n    while length(right) > 0:\n        append right[0] to result\n        right = right[1...length(right)-1]\n    \n    return result"
              }
            ],
            "data": {
              "inputs": [
                {
                  "id": "merge-sort-implementation",
                  "name": "归并排序实现",
                  "type": "code",
                  "language": "python"
                }
              ]
            }
          }
        ]
      },
      {
        "id": "section-2",
        "title": "算法测试",
        "steps": [
          {
            "id": "step-4",
            "title": "生成测试数据",
            "description": "生成不同规模和特性的测试数据集。",
            "resources": [
              {
                "id": "test-data-generation",
                "type": "code",
                "name": "测试数据生成代码",
                "content": "import random\n\ndef generate_random_array(size):\n    return [random.randint(0, 1000) for _ in range(size)]\n\ndef generate_nearly_sorted_array(size):\n    arr = list(range(size))\n    # 交换约5%的元素位置\n    swaps = int(size * 0.05)\n    for _ in range(swaps):\n        i, j = random.randint(0, size-1), random.randint(0, size-1)\n        arr[i], arr[j] = arr[j], arr[i]\n    return arr\n\ndef generate_reversed_array(size):\n    return list(range(size, 0, -1))\n\n# 生成不同规模的数据集\nsizes = [100, 1000, 10000]\nrandom_arrays = {size: generate_random_array(size) for size in sizes}\nnearly_sorted_arrays = {size: generate_nearly_sorted_array(size) for size in sizes}\nreversed_arrays = {size: generate_reversed_array(size) for size in sizes}"
              }
            ],
            "data": {
              "outputs": [
                {
                  "id": "test-data",
                  "name": "测试数据集",
                  "type": "object"
                }
              ]
            }
          },
          {
            "id": "step-5",
            "title": "实现性能测试框架",
            "description": "创建测试框架，测量不同算法在各种数据集上的执行时间。",
            "resources": [
              {
                "id": "performance-test-code",
                "type": "code",
                "name": "性能测试代码框架",
                "content": "import time\nimport copy\n\ndef measure_time(sort_function, array):\n    array_copy = copy.deepcopy(array)\n    start_time = time.time()\n    sort_function(array_copy)\n    end_time = time.time()\n    return end_time - start_time\n\ndef run_performance_tests(algorithms, test_arrays):\n    results = {}\n    for algo_name, algo_func in algorithms.items():\n        results[algo_name] = {}\n        for array_type, arrays in test_arrays.items():\n            results[algo_name][array_type] = {}\n            for size, array in arrays.items():\n                execution_time = measure_time(algo_func, array)\n                results[algo_name][array_type][size] = execution_time\n    return results\n\n# 排序算法集合\nalgorithms = {\n    'Bubble Sort': bubble_sort,\n    'Quick Sort': lambda arr: quick_sort(arr, 0, len(arr)-1),\n    'Merge Sort': merge_sort\n}\n\n# 测试数据集\ntest_arrays = {\n    'Random': random_arrays,\n    'Nearly Sorted': nearly_sorted_arrays,\n    'Reversed': reversed_arrays\n}\n\n# 运行测试\nresults = run_performance_tests(algorithms, test_arrays)"
              }
            ],
            "data": {
              "outputs": [
                {
                  "id": "performance-results",
                  "name": "性能测试结果",
                  "type": "object"
                }
              ]
            }
          }
        ]
      },
      {
        "id": "section-3",
        "title": "结果分析",
        "steps": [
          {
            "id": "step-6",
            "title": "生成性能比较图表",
            "description": "根据测试结果生成算法性能比较图表。",
            "resources": [
              {
                "id": "visualization-code",
                "type": "code",
                "name": "可视化代码",
                "content": "import matplotlib.pyplot as plt\nimport numpy as np\n\ndef plot_performance_comparison(results):\n    # 设置图表样式\n    plt.figure(figsize=(15, 10))\n    array_types = list(results[list(results.keys())[0]].keys())\n    num_types = len(array_types)\n    \n    # 为每种数组类型创建子图\n    for i, array_type in enumerate(array_types):\n        plt.subplot(1, num_types, i+1)\n        \n        # 获取所有算法和数组大小\n        algorithms = list(results.keys())\n        sizes = list(results[algorithms[0]][array_type].keys())\n        sizes.sort()\n        \n        # 为每种算法绘制线条\n        for algo in algorithms:\n            times = [results[algo][array_type][size] for size in sizes]\n            plt.plot(sizes, times, marker='o', label=algo)\n        \n        plt.title(f'Performance on {array_type} Arrays')\n        plt.xlabel('Array Size')\n        plt.ylabel('Execution Time (s)')\n        plt.legend()\n        plt.grid(True)\n        plt.xscale('log')\n    \n    plt.tight_layout()\n    plt.savefig('sorting_algorithm_performance.png')\n    plt.show()\n\n# 绘制性能比较图表\nplot_performance_comparison(results)"
              }
            ],
            "data": {
              "outputs": [
                {
                  "id": "performance-chart",
                  "name": "性能比较图表",
                  "type": "image"
                }
              ]
            }
          },
          {
            "id": "step-7",
            "title": "分析时间复杂度",
            "description": "根据测试结果分析各算法的实际时间复杂度，并与理论复杂度对比。",
            "resources": [
              {
                "id": "complexity-analysis",
                "type": "document",
                "name": "时间复杂度分析指南",
                "content": "# 排序算法复杂度分析指南\n\n## 理论时间复杂度\n\n1. **冒泡排序**\n   - 最佳情况：O(n) - 当数组已经排序时\n   - 平均情况：O(n²)\n   - 最差情况：O(n²) - 当数组逆序排列时\n\n2. **快速排序**\n   - 最佳情况：O(n log n) - 当每次划分都在中间位置时\n   - 平均情况：O(n log n)\n   - 最差情况：O(n²) - 当每次划分都选择了最小或最大元素作为枢轴时\n\n3. **归并排序**\n   - 最佳情况：O(n log n)\n   - 平均情况：O(n log n)\n   - 最差情况：O(n log n)\n\n## 实际复杂度分析方法\n\n1. 对数据进行对数变换后，查看其线性关系\n2. 计算不同规模下的时间比率\n3. 使用最小二乘法拟合复杂度函数\n\n例如，如果时间复杂度为O(n²)，那么当输入规模增加10倍时，执行时间应该增加约100倍。"
              }
            ],
            "data": {
              "inputs": [
                {
                  "id": "complexity-analysis-result",
                  "name": "复杂度分析结果",
                  "type": "text"
                }
              ]
            }
          },
          {
            "id": "step-8",
            "title": "分析算法性能与数据特性的关系",
            "description": "讨论不同排序算法在各类数据集上的表现差异及原因。",
            "data": {
              "inputs": [
                {
                  "id": "performance-data-relation",
                  "name": "算法性能与数据特性关系分析",
                  "type": "text"
                }
              ]
            },
            "hints": [
              "考虑为什么快速排序在已排序数组上表现较差？",
              "为什么归并排序在各种数据集上性能较为稳定？",
              "哪种算法对输入数据的敏感性最低？为什么？"
            ]
          }
        ]
      },
      {
        "id": "section-4",
        "title": "实验报告",
        "steps": [
          {
            "id": "step-9",
            "title": "总结实验结果",
            "description": "总结各算法的性能特点和适用场景。",
            "data": {
              "inputs": [
                {
                  "id": "experiment-summary",
                  "name": "实验结果总结",
                  "type": "text"
                }
              ]
            }
          },
          {
            "id": "step-10",
            "title": "扩展思考",
            "description": "讨论如何改进算法性能或适应特定数据特性。",
            "data": {
              "inputs": [
                {
                  "id": "extension-thoughts",
                  "name": "扩展思考",
                  "type": "text"
                }
              ]
            },
            "hints": [
              "考虑如何优化快速排序在已排序数据上的表现？",
              "有哪些混合排序策略可以结合多种算法的优点？",
              "在实际应用中，如何根据数据特性选择最合适的排序算法？"
            ]
          }
        ]
      }
    ]
  },
  
  "assessment": {
    "criteria": [
      {
        "id": "algorithm-implementation",
        "name": "算法实现",
        "weight": 0.3,
        "rubric": [
          {
            "score": 5,
            "description": "算法实现完全正确，代码结构清晰，注释充分。"
          },
          {
            "score": 3,
            "description": "算法实现基本正确，代码结构一般，注释不够详细。"
          },
          {
            "score": 1,
            "description": "算法实现有误，代码结构混乱，缺乏注释。"
          }
        ]
      },
      {
        "id": "performance-analysis",
        "name": "性能分析",
        "weight": 0.4,
        "rubric": [
          {
            "score": 5,
            "description": "测试方法科学，分析透彻，结论正确，并有深入见解。"
          },
          {
            "score": 3,
            "description": "测试方法基本合理，分析基本正确，结论基本准确。"
          },
          {
            "score": 1,
            "description": "测试方法不当，分析肤浅，结论有误。"
          }
        ]
      },
      {
        "id": "report-quality",
        "name": "报告质量",
        "weight": 0.3,
        "rubric": [
          {
            "score": 5,
            "description": "报告结构完整，逻辑清晰，图表丰富，讨论深入。"
          },
          {
            "score": 3,
            "description": "报告结构基本完整，逻辑基本清晰，有一定图表和讨论。"
          },
          {
            "score": 1,
            "description": "报告结构不完整，逻辑混乱，缺乏图表，讨论浅显。"
          }
        ]
      }
    ],
    "automatedChecks": [
      {
        "id": "algorithm-correctness",
        "type": "code-test",
        "target": ["bubble-sort-implementation", "quick-sort-implementation", "merge-sort-implementation"],
        "tests": [
          {
            "input": [5, 1, 4, 2, 8],
            "expected": [1, 2, 4, 5, 8]
          },
          {
            "input": [1, 2, 3, 4, 5],
            "expected": [1, 2, 3, 4, 5]
          },
          {
            "input": [5, 4, 3, 2, 1],
            "expected": [1, 2, 3, 4, 5]
          }
        ],
        "feedback": {
          "pass": "排序算法实现正确。",
          "fail": "排序算法实现有误，请检查代码逻辑。"
        }
      }
    ]
  },
  
  "aiAssistance": {
    "guidance": {
      "enabled": true,
      "interventionPoints": [
        {
          "id": "quick-sort-pivot",
          "triggerType": "code-pattern",
          "conditions": "contains(quick-sort-implementation, 'pivot = array[high]') && !contains(quick-sort-implementation, 'middle')",
          "actions": {
            "suggestHint": true,
            "message": "当前快速排序实现使用的是最后一个元素作为枢轴，这在处理已排序或反向排序数组时可能导致O(n²)的最差性能。考虑使用随机选择或三数取中法选择枢轴，以提高算法在这些情况下的性能。"
          }
        },
        {
          "id": "bubble-sort-optimization",
          "triggerType": "code-pattern",
          "conditions": "!contains(bubble-sort-implementation, 'swapped')",
          "actions": {
            "suggestHint": true,
            "message": "考虑为冒泡排序添加一个标志，用于检测在一次遍历中是否发生了交换。如果没有交换，说明数组已经排序，可以提前终止算法，优化最佳情况下的性能。"
          }
        }
      ]
    },
    "dataAnalysis": {
      "enabled": true,
      "analysisTypes": [
        {
          "id": "complexity-estimation",
          "description": "估计算法的实际时间复杂度",
          "applicableData": ["performance-results"],
          "methods": ["regression-analysis"],
          "output": {
            "id": "estimated-complexities",
            "name": "估计的时间复杂度",
            "type": "object"
          }
        }
      ]
    },
    "reportGeneration": {
      "enabled": true,
      "templates": [
        {
          "id": "algorithm-comparison-report",
          "sections": [
            {
              "title": "算法实现概述",
              "contentType": "auto-generated",
              "source": ["bubble-sort-implementation", "quick-sort-implementation", "merge-sort-implementation"]
            },
            {
              "title": "性能测试结果",
              "contentType": "auto-generated",
              "source": "performance-results",
              "visualization": {
                "type": "chart",
                "source": "performance-chart"
              }
            },
            {
              "title": "时间复杂度分析",
              "contentType": "ai-assisted",
              "source": "complexity-analysis-result",
              "aiPrompt": "基于测试结果，分析各算法的实际时间复杂度与理论复杂度的对比。"
            },
            {
              "title": "算法性能与数据特性关系",
              "contentType": "ai-assisted",
              "source": "performance-data-relation",
              "aiPrompt": "分析不同排序算法在各类数据集上的表现差异及原因。"
            },
            {
              "title": "结论与建议",
              "contentType": "ai-assisted",
              "source": ["experiment-summary", "extension-thoughts"],
              "aiPrompt": "总结各算法的性能特点和适用场景，并提出可能的改进方向。"
            }
          ]
        }
      ]
    }
  }
}
```
