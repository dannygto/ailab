# 人工智能辅助实验平台 - 版本构建指南

*更新日期: 2025年6月22日*

## 概述

人工智能辅助实验平台提供三个不同版本，面向不同教育阶段和应用场景：

1. **普教版（Basic Edition）** - 适用于K12教育（小学、初中、高中）
2. **普教AI版（AI Enhanced Edition）** - 在普教版基础上增加高级AI功能
3. **高教版（Professional Edition）** - 适用于高职、大学、研究生院，包含全套高级功能

本文档提供了如何为不同版本构建应用程序的详细说明。

## 构建环境准备

确保您的开发环境满足以下要求：

- Node.js v16+
- npm 或 yarn 包管理器
- 全局安装 cross-env 工具: `npm install -g cross-env`

## 构建命令

### 1. 普教版（Basic Edition）

```bash
# 开发环境
npm run dev:basic

# 生产环境
npm run build:basic
```

### 2. 普教AI版（AI Enhanced Edition）

```bash
# 开发环境
npm run dev:ai-enhanced

# 生产环境
npm run build:ai-enhanced
```

### 3. 高教版（Professional Edition）

```bash
# 开发环境
npm run dev:professional

# 生产环境
npm run build:professional
```

## 构建配置

构建命令通过设置环境变量 `REACT_APP_EDITION` 来确定应用版本。在项目根目录的 `package.json` 文件中添加了相应的脚本命令：

```json
"scripts": {
  "dev:basic": "cross-env REACT_APP_EDITION=basic npm start",
  "dev:ai-enhanced": "cross-env REACT_APP_EDITION=ai-enhanced npm start",
  "dev:professional": "cross-env REACT_APP_EDITION=professional npm start",
  
  "build:basic": "cross-env REACT_APP_EDITION=basic npm run build",
  "build:ai-enhanced": "cross-env REACT_APP_EDITION=ai-enhanced npm run build",
  "build:professional": "cross-env REACT_APP_EDITION=professional npm run build"
}
```

## 如何工作

构建过程使用 `FeatureFlagsProvider` 组件根据指定的版本启用或禁用不同功能。环境变量 `REACT_APP_EDITION` 的值将被传递给 `FeatureFlagsProvider` 的 `initialEdition` 属性。

### 默认版本设置

如果没有指定 `REACT_APP_EDITION` 环境变量，应用将默认使用 `basic` 版本（普教版）。

```typescript
// 从环境变量获取版本
const editionFromEnv = process.env.REACT_APP_EDITION as EditionType || 'basic';

// 在应用程序入口点设置
<FeatureFlagsProvider initialEdition={editionFromEnv}>
  <App />
</FeatureFlagsProvider>
```

## 功能区分与限制

各版本的功能限制由 `featureFlags.tsx` 中的 `getFeatureFlagsByEdition` 函数定义。下面是各版本功能对比：

| 功能模块 | 普教版 | 普教AI版 | 高教版 |
|---------|-------|---------|-------|
| 基础实验管理 | ✅ | ✅ | ✅ |
| 基础AI助手 | ✅ | ✅ | ✅ |
| 基础数据可视化 | ✅ | ✅ | ✅ |
| 实验资源管理 | ✅ | ✅ | ✅ |
| 高级AI助手 | ❌ | ✅ | ✅ |
| AI实验分析 | ❌ | ✅ | ✅ |
| AI图像识别 | ❌ | ✅ | ✅ |
| 智能报告生成 | ❌ | ✅ | ✅ |
| 个性化学习路径 | ❌ | ✅ | ✅ |
| 高级数据可视化 | ❌ | ✅ | ✅ |
| 高级实验设计 | ❌ | ❌ | ✅ |
| 远程设备接入 | ❌ | ❌ | ✅ |
| 科研项目管理 | ❌ | ❌ | ✅ |
| 协作实验环境 | ❌ | ❌ | ✅ |
| 开放API接口 | ❌ | ❌ | ✅ |
| 扩展系统 | ❌ | ❌ | ✅ |
| 多维数据分析 | ❌ | ❌ | ✅ |

## 在代码中有条件地渲染功能

在开发过程中，使用 `FeatureGate` 组件或 `isFeatureEnabled` 函数来有条件地渲染功能。

### 使用 FeatureGate 组件

```tsx
import { FeatureGate } from '../features/featureFlags';

// 在组件中
return (
  <div>
    {/* 基础功能 - 所有版本可见 */}
    <h1>实验管理</h1>
    
    {/* 高级AI功能 - 仅在普教AI版和高教版可见 */}
    <FeatureGate feature="aiExperimentAnalysis">
      <div>
        <h2>AI实验分析</h2>
        {/* 分析功能UI */}
      </div>
    </FeatureGate>
    
    {/* 专业功能 - 仅在高教版可见 */}
    <FeatureGate 
      feature="remoteEquipmentAccess"
      fallback={<p>此功能仅在高教版可用</p>}
    >
      <div>
        <h2>远程设备接入</h2>
        {/* 设备接入UI */}
      </div>
    </FeatureGate>
  </div>
);
```

### 使用 isFeatureEnabled 函数

```tsx
import { useFeatureFlags } from '../features/featureFlags';

function MyComponent() {
  const { isFeatureEnabled } = useFeatureFlags();
  
  // 检查功能是否可用
  const canUseAdvancedAnalysis = isFeatureEnabled('aiExperimentAnalysis');
  
  return (
    <div>
      {/* 基于条件渲染 */}
      {canUseAdvancedAnalysis && (
        <AdvancedAnalysisTools />
      )}
    </div>
  );
}
```

## 许可证管理

每个版本都与特定的许可证类型相关联。许可证验证通过 `LicensingProvider` 组件处理，该组件验证许可证并确保用户只能访问其许可证允许的功能。

在生产环境中，应用将在启动时验证许可证，并根据许可证指定的版本设置相应的功能标志。如果许可证无效或已过期，应用将回退到基础版本或显示许可证错误消息。

## 版本自定义

客户可以通过购买功能扩展包来自定义其版本。例如，普教版客户可以购买特定的高级AI功能，而无需升级到完整的普教AI版。

这种灵活性通过在许可证中包含自定义功能列表来实现：

```typescript
// 自定义许可证示例
const customLicense = {
  licenseKey: "CUSTOM-XXXX-XXXX",
  edition: "basic",
  features: [
    "basicExperiments",
    "basicAIAssistant", 
    "basicDataVisualization",
    "aiImageRecognition", // 额外购买的高级功能
  ],
  // ...其他许可证信息
};
```

## 技术支持

如有任何关于版本构建或配置的问题，请联系技术支持团队：

- 邮箱：support@aicamplatform.com
- 电话：+86-10-12345678
